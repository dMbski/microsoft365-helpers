Powershell 7 script, tested. 
If the data from $csvDataPath  = "teams.csv" in a row is invalid, an error file is created in which the causes are recorded in $csvErrorPath = "teams-errors.csv"

Required libraries, including Microsoft.Graph; install them before running the script.

"C:\Program Files\PowerShell\7\pwsh.exe" -NoProfile

Install-Module Microsoft.Graph 
